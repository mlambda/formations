\begin{frame}
  \frametitle{Data Mining}
  \imgtw[0.8]{ml-craftmanship}
\end{frame}


\begin{frame}
  \frametitle{Data Mining}
  Attention aux différents biais de vos données !
  \begin{itemize}[<+->]
  \item \red{variables confondantes} (Ex : ``obésité'' dans la corrélation entre ``conso. viande'' et ``cancer colon'')
  \item \red{biais statistiques}
    \begin{itemize}[<+->]
    \item sélection, autosélection
    \item mesure
    \item attrition
    \item …
    \end{itemize}
  \item trouver de fausses variables explicatives
  \end{itemize}
  \pause
  → Le garder en tête pendant toute l'étude.
\end{frame}

\begin{frame}
  \frametitle{Data Mining}
  \begin{center}
    Meilleures données $>$ Meilleurs modèles \\
    (trash-in, trash-out) \\
  \end{center}
  → À garder en tête pendant toute l'étude, en particulier durant
  l'entraînement de modèles
\end{frame}

\begin{frame}
  \frametitle{Préparation des données}
  \begin{itemize}
  \item valeurs manquantes
  \item préprocessing (texte, image)
  \item standardisation
  \item transformation
  \end{itemize}
\end{frame}

\begin{frame}
  \frametitle{Préparation des données — valeurs manquantes}
  Gênant pour certains modèles. Plusieurs options :
  \begin{itemize}[<+->]
  \item supprimer les enregistrements
  \item remplacer par une valeur (imputation) :
    \begin{itemize}[<+->]
    \item constante
    \item moyenne de la colonne
    \item prédiction d'un autre modèle
    \end{itemize}
  \end{itemize}
\end{frame}

\begin{frame}
  \frametitle{Préparation des données — préprocessing}
  \begin{itemize}
  \item tokenizer, POS-tagger le texte (\url{https://spacy.io/})
  \item utiliser un réseau de neurones préentraîné sur les images
    (\url{https://keras.io/applications/})
  \item appliquer une transformée de fourier sur le son
  \item …
  \end{itemize}
\end{frame}

\begin{frame}
  \frametitle{Préparation des données — standardisation}
  Beaucoup de modèles travaillent mieux avec des données normales et
  sont plus efficaces autour de $[-5, 5]$ :
  \begin{itemize}
  \item centrer sur la moyenne puis diviser par l'écart-type
  \item transformation de Box-Cox en cas d'asymétrie
  \item transformations spécifiques en fonction de la distribution
  \end{itemize}
\end{frame}

\begin{frame}
  \frametitle{Préparation des données — transformation}
  Quand un modèle n'accepte pas de données catégorielles :
  \begin{itemize}
  \item label encoding si ordinal
  \item one-hot encoding sinon
  \end{itemize}
\end{frame}

\begin{frame}
  \frametitle{Préparation des données — label encoding}
  Si les données sont ordinales :
  \begin{columns}
    \begin{column}{.5\tw}
      \begin{figure}
        \centering
        Ordinal :\\[.5cm]
        \begin{tabular}{c}
          \toprule
          Température \\
          \midrule
          Froid \\
          Froid \\
          Tiède \\
          Chaud \\
          Tiède \\
          \bottomrule
        \end{tabular}
      \end{figure}
    \end{column}
    \begin{column}{.5\tw}
      \begin{figure}
        \centering
        Label encoding :\\[.5cm]
        \begin{tabular}{ccc}
          \toprule
          Température \\
          \midrule
          1 \\
          1 \\
          2 \\
          3 \\
          2 \\
          \bottomrule
        \end{tabular}
      \end{figure}
    \end{column}
  \end{columns}
\end{frame}

\begin{frame}
  \frametitle{Préparation des données — one-hot encoding}
  Remplacer une feature par $n$ features avec $n$ le nombre de
  catégories.
  \begin{columns}
    \begin{column}{.5\tw}
      \begin{figure}
        \centering
        Catégoriel :\\[.5cm]
        \begin{tabular}{c}
          \toprule
          Couleur \\
          \midrule
          Rouge \\
          Rouge \\
          Jaune \\
          Vert \\
          Jaune \\
          \bottomrule
        \end{tabular}
      \end{figure}
    \end{column}
    \begin{column}{.5\tw}
      \begin{figure}
        \centering
        One-hot :\\[.5cm]
        \begin{tabular}{ccc}
          \toprule
          Rouge & Jaune & Vert \\
          \midrule
          1 & 0 & 0 \\
          1 & 0 & 0 \\
          0 & 1 & 0 \\
          0 & 0 & 1 \\
          0 & 1 & 0 \\
          \bottomrule
        \end{tabular}
      \end{figure}
    \end{column}
  \end{columns}
\end{frame}

\begin{frame}
  \frametitle{Exploration des données}
  But :
  \begin{itemize}[<+->]
  \item se rendre compte des prétraitements à effectuer (Box-Cox,
    imputations, etc)
  \item comprendre la variable de sortie : distribution, équilibre des
    classes, features les plus corrélées, …
  \item détecter les corrélations
  \item appréhender la complexité nécessaire du modèle
  \end{itemize}
  \onslide<+->{\red{Attention : garder des données de côté (test set)
      et ne pas les regarder. \textbf{Sinon biais statistique énorme.}}}
\end{frame}

\begin{frame}
  \frametitle{Outils}
  Plusieurs outils sont disponibles pour explorer des données. On
  utilise principalement des plots pour :
  \begin{itemize}
  \item se renseigner sur une distribution
  \item se renseigner sur la corrélation de deux distributions
  \item visualiser des corrélations linéaires
  \end{itemize}
  Les outils suivants sont sauf mention contraire présents dans
  \href{https://seaborn.pydata.org/}{\texttt{seaborn}}.
\end{frame}

\begin{frame}
  \frametitle{Outils — count plot}
  \imgtw{countplot}
\end{frame}

\begin{frame}
  \frametitle{Outils — dist plot}
  \imgtw{distplot}
\end{frame}

\begin{frame}
  \frametitle{Outils — qq plot}
  \imgtw{qqplot}
  Attention, pas \href{https://seaborn.pydata.org/}{\texttt{seaborn}}
  mais
  \href{http://www.statsmodels.org/stable/index.html}{\texttt{statsmodel}}
  ou
  \href{https://docs.scipy.org/doc/scipy/reference/stats.html}{\texttt{scipy.stats}}.
\end{frame}

\begin{frame}
  \frametitle{Outils — bar plot}
  \imgtw{barplot}
\end{frame}

\begin{frame}
  \frametitle{Outils — scatter plot}
  \imgtw[.6]{scatter}
\end{frame}

\begin{frame}
  \frametitle{Outils — violin plot}
  \imgtw{violinplot}
\end{frame}

\begin{frame}
  \frametitle{Outils — pair plot}
  \imgtw[.7]{pairplot}
\end{frame}

\begin{frame}
  \frametitle{Outils — correlation matrix}
  \imgtw[.7]{corrmat}
\end{frame}

\begin{frame}
  \frametitle{Mode opératoire}
  Bonnes pratiques pour explorer un dataset :
  \begin{itemize}[<+->]
  \item analyser la(es) variable(s) de sortie (countplot/distplot)
  \item trouver les corrélations linéaires les plus fortes
  \item analyser les variables correspondantes
  \item regarder s'il y a des outliers évidents dans ces variables
  \end{itemize}
\end{frame}
