\begin{frame}{Introduction}
  Goals:
  \begin{itemize}
    \item Publish a Python software as a proper PyPI package
    \item Define metadata \& dependencies correctly
  \end{itemize}
\end{frame}

\begin{frame}{Python package}
  To turn a folder containing Python sources into a package, you need to:

  \begin{itemize}
    \item Add \texttt{\_\_init\_\_.py} files in each source directory
    \item Add some metadata (\textit{how much} and \textit{what exactly} will depend on the build tool)
  \end{itemize}
\end{frame}

\begin{frame}{Tools}
  \begin{itemize}
    \item \texttt{setup.py}, \& \texttt{setuptools}
    \item \texttt{Pipenv}
    \item \texttt{poetry}
  \end{itemize}

  \texttt{poetry} is the recommended choice. Simple, modern, efficient.
\end{frame}

\begin{frame}{Structure of a \texttt{poetry} package}
  \mintedcustomcode{python/production/packaging/structure}{text}
  \begin{alertblock}{Warning}
    The source folder is not \texttt{src} but your package name (often your project name in lowercase with \texttt{-} replaced by \texttt{\_})
  \end{alertblock}
\end{frame}

\begin{frame}{\texttt{pyproject.toml} file}
  Contains:

  \begin{itemize}
    \item Metadata
    \item Dependencies specification (but most often not frozen versions)
    \item Dev dependencies specification (same as above)
    \item Entrypoints
  \end{itemize}
\end{frame}

\begin{frame}{\texttt{pyproject.toml} example file}
  \mintedcustomcode{python/production/packaging/example}{toml}
\end{frame}

\begin{frame}{\texttt{poetry} usage}
  A few useful \bluelink{https://python-poetry.org/docs/cli/}{commands} for packaging:
  \begin{description}
    \item[\texttt{poetry version}] Displays or modifies the package version
    \item[\texttt{poetry build}] Creates the files needed to upload the package to PyPI
    \item[\texttt{poetry publish}] Publishes the package
  \end{description}
\end{frame}

\begin{frame}{PyPI repository}
  Python packages repository:

  \begin{description}
    \item[Projects] 400k+
    \item[Versions] 4M+
    \item[Files] 7M+
    \item[Users] 600k+
  \end{description}
\end{frame}

\begin{frame}{Pros}
  \begin{itemize}
    \item Usable from \texttt{pip}, \texttt{poetry}, \texttt{Pipenv}, â€¦
    \item \textbf{Some} security: impossible to replace the files of a given version by new files
    \item Usable from CI
  \end{itemize}
\end{frame}
