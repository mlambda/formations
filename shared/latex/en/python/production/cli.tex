\begin{frame}{Introduction}
  Goals:
  \begin{itemize}
    \item Create easy-to-use tools
    \item Use your Python programs in your (bash) scripts
  \end{itemize}
\end{frame}

\begin{frame}{Mechanisms}
  \begin{itemize}
    \item \texttt{sys.argv} exposes the arguments received by your program as a list
    \item \texttt{argparse}, \texttt{click} or \texttt{Typer} can parse this list for you
  \end{itemize}  
\end{frame}

\begin{frame}{\texttt{argparse}}
  To define a CLI with \texttt{argparse}, you need to:
  \begin{itemize}
    \item Create a parser
    \item Call this parser from the entrypoint of your program
    \item Use the received arguments to call the corresponding parts of your program
  \end{itemize}
\end{frame}

\begin{frame}{Parser creation}
  First we create a \texttt{argparse.ArgumentParser}, then we add arguments with the \texttt{add\_argument} method:
  \mintedpycode{python/cli/creation}
\end{frame}

\begin{frame}{Adding an argument}
  \texttt{add\_argument} has many options. Amongst them, you can specify:

  \begin{itemize}
    \item A short string name (\texttt{"-d"}) and a long one (\texttt{"--directory"})
    \item A help string (\texttt{help="Help message for argument XYZ."})
    \item A type (\texttt{type=int})
    \item An action, to create boolean flags amongst other things
    \item A default value
  \end{itemize}

  The \bluelink{https://docs.python.org/3/library/argparse.html\#the-add-argument-method}{official documentation} is very thorough.
\end{frame}

\begin{frame}{Multiple commands}
  You can define multiple commands by creating sub-parsers that are then used as normal parsers to define a given command:

  \mintedpycode{python/cli/subparsers}
\end{frame}

\begin{frame}{Parser usage}
  First we call the \texttt{parse\_args} method, then we handle the received arguments.

  \mintedpycode{python/cli/usage}
\end{frame}

\begin{frame}{Advanced usage to couple the CLI and the called feature}
  \begin{alertblock}{Warning}
    Not suited for a first exposition, you can study that after having mastered simple CLIs.
  \end{alertblock}
  \mintedpycode{python/cli/usage-coupled}

  \begin{itemize}
    \item \texttt{vars} turns the object \texttt{args} into a dictionary
    \item \texttt{**} «~spreads~» the dictionary into keywords and values
    \item deletion of unused keys with \texttt{delattr} before calling the target function/class
  \end{itemize}
\end{frame}

\begin{frame}{Some reasons to use \texttt{argparse}}
  \begin{itemize}
    \item It generates a help argument and text automatically
    \item It gives informative error messages when your program is used incorrectly 
  \end{itemize}
\end{frame}
