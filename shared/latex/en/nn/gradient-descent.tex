
\begin{frame}{Principle}
  \begin{columns}
    \begin{column}{0.5\textwidth}
      Compute the error gradient \emph{w.r.t.} the parameters:
      \[
      \frac{\partial{E}}{\partial{w_i}}
      \]
      Update:
      \[
      w_i \leftarrow w_i - \gamma\frac{\partial{E}}{\partial{w_i}}
      \]
      where $0 < \gamma < 1$ (learning rate)
    \end{column}
    \begin{column}{0.5\textwidth}
      \V{["plt/gradient-descent-en", "tw", 1] | image}
    \end{column}
  \end{columns}
\end{frame}

\begin{frame}{Algorithm}
  \begin{enumerate}[<+->]
    \item Random initialization of the model
    \item While no stopping criterion is satisfied:
      \begin{itemize}
        \item Selection of a random \textbf{batch} of samples
        \item \textbf{Forward}: Model output computation on the selected batch
        \item Computation of the error (loss) compared to the expected output
        \item \textbf{Backward}: Error gradient retropropagation (model update)
        \item Stopping criteria computation
      \end{itemize}
  \end{enumerate}
\end{frame}


\begin{frame}{Derivation example --- Linear regression}
  \begin{minipage}[l]{0.49\linewidth}
    \begin{align*}
      E & = \frac{1}{2n} \sum_{i=1}^n( \hat{y_i} - y_i )^2 \\
      E & = \frac{1}{2n}\sum_{i=1}^n( ax_i + b - y_i )^2 \\
      & ... \\
      \frac{\partial E}{\partial a} & = \frac{1}{n}\sum^n_{i=1}(ax_i + b - y_i)x_i \\
      \frac{\partial E}{\partial b} & = \frac{1}{n}\sum^n_{i=1}(ax_i + b - y_i) \\
    \end{align*}
  \end{minipage}\hfill
  \begin{minipage}[c]{0.49\linewidth}
    \begin{center}
      $\boxed{\hat{y_i} = ax_i+b}$
    \end{center}

    \begin{center}
      $\boxed{U^{2\;\prime}=2U' \times U}$
    \end{center}
    \vfill
    \begin{center}
      \textbf{Update}

      $a \leftarrow a - \gamma\frac{\partial{E}}{\partial{a}}$ \\
      $b \leftarrow b - \gamma\frac{\partial{E}}{\partial{b}}$ \\
      $\;$ \\
      where $0 < \gamma < 1$ (learning rate)
    \end{center}
  \end{minipage}\hfill
\end{frame}

\begin{frame}{Example}
  Random initialization ($\gamma = 0.01$)
  \begin{itemize}
    \item a = 0.58 ($\text{true}\, a = 3.0$)
    \item b = 0.25 ($\text{true}\, b = 0.5$)
  \end{itemize}
  \V{["img/regression-1", "th", 0.6] | image}
\end{frame}

\begin{frame}{Example}
  \begin{itemize}
    \item a = 0.58 ($\text{true}\, a = 3.0$)
    \item b = 0.25 ($\text{true}\, b = 0.5$)
  \end{itemize}
  \V{["img/regression-error", "th", 0.6] | image}
\end{frame}

\begin{frame}{Example}
  \begin{itemize}
    \item a = 1.50 ($\text{true}\, a = 3.0$)
    \item b = 0.35 ($\text{true}\, b = 0.5$)
  \end{itemize}
  \V{["img/regression-2", "th", 0.6] | image}
\end{frame}

\begin{frame}{Example}
  \begin{itemize}
    \item a = 2.10 ($\text{true}\, a = 3.0$)
    \item b = 0.40 ($\text{true}\, b = 0.5$)
  \end{itemize}
  \V{["img/regression-3", "th", 0.6] | image}
\end{frame}

\begin{frame}{Example}
  \begin{itemize}
    \item a = 2.48 ($\text{true}\, a = 3.0$)
    \item b = 0.43 ($\text{true}\, b = 0.5$)
  \end{itemize}
  \V{["img/regression-4", "th", 0.6] | image}
\end{frame}

\begin{frame}{Example}
  \begin{itemize}
    \item a = 2.73 ($\text{true}\, a = 3.0$)
    \item b = 0.46 ($\text{true}\, b = 0.5$)
  \end{itemize}
  \V{["img/regression-5", "th", 0.6] | image}
\end{frame}

\begin{frame}{Example}
  \begin{itemize}
    \item a = 2.89 ($\text{true}\, a = 3.0$)
    \item b = 0.47 ($\text{true}\, b = 0.5$)
  \end{itemize}
  \V{["img/regression-6", "th", 0.6] | image}
\end{frame}

\begin{frame}{Example}
  \begin{itemize}
    \item a = 2.99 ($\text{true}\, a = 3.0$)
    \item b = 0.48 ($\text{true}\, b = 0.5$)
  \end{itemize}
  \V{["img/regression-7", "th", 0.6] | image}
\end{frame}

\begin{frame}{Example}
  \begin{itemize}
    \item a = 3.06 ($\text{true}\, a = 3.0$)
    \item b = 0.49 ($\text{true}\, b = 0.5$)
  \end{itemize}
  \V{["img/regression-8", "th", 0.6] | image}
\end{frame}

\begin{frame}{Example}
  \begin{itemize}
    \item a = 3.10 ($\text{true}\, a = 3.0$)
    \item b = 0.49 ($\text{true}\, b = 0.5$)
  \end{itemize}
  \V{["img/regression-9", "th", 0.6] | image}
\end{frame}

\begin{frame}{Example}
  \begin{itemize}
    \item a = 3.13 ($\text{true}\, a = 3.0$)
    \item b = 0.50 ($\text{true}\, b = 0.5$)
  \end{itemize}
  \V{["img/regression-10", "th", 0.6] | image}
\end{frame}
