\begin{frame}{Clustering metrics --- Introduction}
  Two cases:

  \begin{enumerate}
    \item If we have annotated data (even insufficient to learn) $\rightarrow$ supervised classification metrics
    \item Otherwise, we evaluate the quality of the clusters
  \end{enumerate}

\end{frame}

\begin{frame}{Clustering metrics --- Application of supervised metrics}
  A prior computation is necessary: the optimal mapping between clusters and labels.

  Several possibilities:

  \begin{itemize}
    \item Hungarian algorithm
    \item Sub-optimal but good first approach: most represented class in each cluster
  \end{itemize}
\end{frame}

\begin{frame}{Clustering metrics --- Inertia}
  \begin{center}
    loss = $\sum_i \sum_j \delta_{i,j}\lVert x_j - \mu_i \rVert^2$
  \end{center}
  with $\delta_{i,j}$ is 1 if the cluster $\mu_i$ is the closest to $x_j$, 0 otherwise
\end{frame}

\begin{frame}{Clustering metrics --- Silhouette}
  Data $x = \{x_1, \dotsc, x_n\}$ , Clusters $\mu = \{\mu_1, \dotsc, \mu_k\}$ and $x_i\in\mu_I$ \\
  \[
  \boxed{a_i = \frac{1}{|\mu_I|-1}\sum_{j\in|\mu_I|, i \neq j} |x_i - x_j|}
  \]
  \[
  \boxed{b_i = \min_{I \neq J} \frac{1}{|\mu_J|}\sum_j |x_i - x_j|}
  \]
  where : \\
  $|\mu_I|$  is the number of elements of x in the cluster $\mu_I$ \\
  $a_i$ : average distance to the points in the same cluster than $x_i$ \\
  $b_i$ : average distance to the points of the nearest cluster which do not contains $x_i$
  
\end{frame}

\begin{frame}{Clustering metrics --- Silhouette}
  
  \begin{center}
    \[
    s_i = \frac{b_i - a_i}{\max\{a_i, b_i\}}\;\;,\;\;
    s_i = \left\{
    \begin{array}{ll}
      1 - a_i/b_i & \mbox{ if } a_i < b_i \\[2mm]
      0 & \mbox{ if } a_i = b_i \\[2mm]
      b_i / a_i - 1 & \mbox{ if } a_i > b_i
    \end{array}\right.
    \]
    
  \end{center}
  with $s_i \in [-1, 1]$ \\
  \\
  $s_i \approx 1 \iff$ $x_i$ well clusterized \\
  $s_i \approx 0 \iff$ $x_i$ at the edge between two clusters\\
  $s_i \approx -1 \iff$ $x_i$ poorly clusterized
\end{frame}

\begin{frame}{Clustering metrics --- Many other metrics}
  \begin{itemize}
  \item Calinski-Harabaz index: Density comparison inter vs intra cluster (no bound, the higher the better)
  \item Davies-Bouldin Index: cluster similarity measurement (the lower the better)
  \item ...
  \end{itemize}
\end{frame}
