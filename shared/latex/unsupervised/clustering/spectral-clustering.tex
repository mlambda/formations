\begin{frame}{Présentation du problème}
    \begin{minipage}{0.49\linewidth}
        \textbf{Clustering de graphe}

        Faire du clustering sur de données qui présente des données structurées en graphe.

        Dans un premier temps, supposons que nous voulions diviser le graphe en deux.
        \\

        \alert{\textbf{Comment séparer ce graphe ?}}
    \end{minipage}
    \begin{minipage}{0.49\linewidth}
        \V{["tikz/graph/spectral-clustering-1", "tw", 1] | image}
    \end{minipage}
\end{frame}
\begin{frame}{Présentation du problème}
    \begin{minipage}{0.49\linewidth}
        \textbf{Clustering de graphe}
        \begin{itemize}
            \item L'objectif est de trouver une séparation qui minimise la conductance ($\approx$ suppression de peu d'arêtes et clusters de tailles similaires)
            \item Calculer la conductance minimale est NP-complet, on lui préfère une analyse spectrale qui fournit une bonne approximation.
    \end{itemize}
        
    \end{minipage}
    \begin{minipage}{0.49\linewidth}
        \V{["tikz/graph/spectral-clustering-2", "tw", 1] | image}
    \end{minipage}
\end{frame}

\begin{frame}{Matrices de graphe}
    Il existe différentes matrices permettant de décrire un graphe :
    \begin{itemize}
        \item La matrice de degrée
        \item La matrice de d'adjacence
        \item La matrice de d'incidence
        \item La matrice laplacienne
    \end{itemize}
\end{frame}

\begin{frame}{Matrice de graphe : Degrée}
    \begin{minipage}{0.49\linewidth}
        \begin{itemize}
            \item Le \alert{degrée d'un nœud} indique le nombre d'arêtes connectées à celui-ci.
            \item La \alert{matrice de degrée} $D$ représente le degrée de chaque nœud dans une matrice diagonale :
            $$
            D = \begin{pmatrix}
                3 & 0 & 0 & 0 & 0 & 0\\
                0 & 2 & 0 & 0 & 0 & 0\\
                0 & 0 & 2 & 0 & 0 & 0\\
                0 & 0 & 0 & 3 & 0 & 0\\
                0 & 0 & 0 & 0 & 2 & 0\\
                0 & 0 & 0 & 0 & 0 & 2
            \end{pmatrix}
            $$
        \end{itemize}
    \end{minipage}
    \begin{minipage}{0.49\linewidth}
        \V{["tikz/graph/spectral-clustering-1", "tw", 1] | image}
    \end{minipage}
\end{frame}

\begin{frame}{Matrice de graphe : Adjacence}
    \begin{minipage}{0.49\linewidth}
        \begin{itemize}
            \item La \alert{matrice d'adjacence} $A$ représente les arêtes entre les nœuds. 
            \item Un 0 représente une absence d'arête entre deux nœuds, un 1 sa présence :
            $$
            A = \begin{pmatrix}
                0 & 1 & 1 & 1 & 0 & 0\\
                1 & 0 & 1 & 0 & 0 & 0\\
                1 & 1 & 0 & 0 & 0 & 0\\
                1 & 0 & 0 & 0 & 1 & 1\\
                0 & 0 & 0 & 1 & 0 & 1\\
                0 & 0 & 0 & 1 & 1 & 0
            \end{pmatrix}
            $$
        \end{itemize}
    \end{minipage}
    \begin{minipage}{0.49\linewidth}
        \V{["tikz/graph/spectral-clustering-1", "tw", 1] | image}
    \end{minipage}
\end{frame}

\begin{frame}{Matrice de graphe : Incidence}
    \begin{minipage}{0.49\linewidth}
        \begin{itemize}
            \item La \alert{matrice d'incidence} $I$ représente la relation entre les nœuds et les arêtes
            \item La matrice est de dimension $n \times p$ avec $n$ le nombe de nœuds et $p$ le nombre d'arêtes
            \begin{itemize}
                \item -1 si un arc sort du nœud
                \item 1 si un arc rentre dans le nœud
                \item 0 si le nœud n'est pas connecté à l'arc
            \end{itemize}
            \item Si le graphe est non orienté, on choisi arbitrairement un graphe orienté correspondant et valide.
        \end{itemize}
    \end{minipage}
    \begin{minipage}{0.49\linewidth}
        \V{["tikz/graph/spectral-clustering-3", "tw", 1] | image}
    \end{minipage}
\end{frame}

\begin{frame}{Matrice de graphe : Incidence}
    \begin{minipage}{0.49\linewidth}
        \begin{itemize}
            \item La matrice est de dimension $n \times p$ avec $n$ le nombe de nœuds et $p$ le nombre d'arêtes
            \begin{itemize}
                \item -1 si un arc sort du nœud
                \item 1 si un arc rentre dans le nœud
                \item 0 si le nœud n'est pas connecté à l'arc
            \end{itemize}
        \end{itemize}
        \scriptsize{
        $$
        I = \begin{pmatrix}
            0 & -1 & -1 & -1 & 0 & 0 & 0\\
            1 & -1 & 0 & 0 & 0 & 0 & 0\\
            1 & 0 & 1 & 0 & 0 & 0 & 0\\
            0 & 0 & 0 & 1 & -1 & -1 & 0\\
            0 & 0 & 0 & 0 & 1 & 0 & -1\\
            0 & 0 & 0 & 0 & 0 & 1 & 1
        \end{pmatrix}
        $$}
    \end{minipage}
    \begin{minipage}{0.49\linewidth}
        \V{["tikz/graph/spectral-clustering-3", "tw", 1] | image}
    \end{minipage}
\end{frame}

\begin{frame}{Matrice de graphe : Laplacienne}
    \begin{minipage}{0.49\linewidth}
        \begin{itemize}
            \item La \alert{laplacienne} $L$ est une matrice particulière de représentation d'un graphe
            \item $L = I^{T}I$
            \item $L = D - A$
        \end{itemize}
        \footnotesize{$$
            L = \begin{pmatrix}
                3 & -1 & -1 & -1 & 0 & 0\\
                -1 & 2 & -1 & 0 & 0 & 0\\
                -1 & -1 & 2 & 0 & 0 & 0\\
                -1 & 0 & 0 & 3 & -1 & -1\\
                0 & 0 & 0 & -1 & 2 & -1\\
                0 & 0 & 0 & -1 & -1 & 2
            \end{pmatrix}
        $$}
    \end{minipage}
    \begin{minipage}{0.49\linewidth}
        \V{["tikz/graph/spectral-clustering-1", "tw", 1] | image}
    \end{minipage}
\end{frame}

\begin{frame}{Spécification du problème}
    \begin{minipage}{0.49\linewidth}
        \begin{itemize}
            \item Le but est de trouver un sous-graphe $G'\subset G$ defini par un vecteur $x$ qui représente l'ensemble des noeuds de $G'$
            \item $G'$ conserve l'ensemble des arêtes possibles entre les noeuds de $G'$
            \visible<2>{\item Exemple : $x =(1,1,0,1,0,1)$}
        \end{itemize}
    \end{minipage}
    \begin{minipage}{0.49\linewidth}
        \only<1>{
            \V{["tikz/graph/spectral-clustering-1", "tw", 1] | image}
        }
        \only<2>{
            \V{["tikz/graph/spectral-clustering-4", "tw", 1] | image}
        }

    \end{minipage}
\end{frame}

\begin{frame}{Spécification du problème}
    Étant donné deux sous graphes $G_1,G_2 \subset G$ tels que l'ensemble des nœuds $x_1$ et $x_2$, respectivement, de $G_1$ et $G_2$ soient mutuellement exclusifs, on cherche $x_1, x_2$ tels que~:
    $$
        \min_{x_1, x_2} L.x_1 + L.x_2
    $$
\end{frame}

\begin{frame}{Spécification du problème}
    Exemple pour la séparation suivante:

    \V{["tikz/graph/spectral-clustering-2", "tw", 0.3] | image}

    $$
        L.x_1 + L.x_2 = 2
    $$

    avec $x_1 = (1,1,1,0,0,0)$ et $x_2 = (0,0,0,1,1,1)$
\end{frame}

\begin{frame}{Spécification du problème (Avancé)}
    Étant donné un graphe $G$ de laplacienne $L$, on cherche le vecteur $x$ de partitionnage tels que~:
    $$
        \min_{x} \frac{x^T L x}{x^T x}
    $$

    Ce qui est équivalent à une erreur quadratique :
    $$
        \min_x \frac{\sum_{(i,j)}(x_i-x_j)^2}{||x||^2}
    $$
    
    On pourra simplifier l'expression en garantissant que $||x||^2 = 1$ :
    $$
        \min_x \sum_{(i,j)}(x_i-x_j)^2
    $$
\end{frame}



\begin{frame}{Vecteurs propres de la laplacienne}
    Les vecteurs propres de la matrice laplacienne vont nous permettre de trouver une solution à notre problème.

    \textbf{\alert{Rappel}}

    Si $x$ est un vecteur propre de $L$ de valeur propre $\lambda$ alors~:
    $$
        Lx = \lambda x
    $$
    A TERMINER
\end{frame}
 
\begin{frame}{Fiedler vector}
\end{frame}

\begin{frame}{Décomposition en cluster}
\end{frame}

\begin{frame}{Cas non-binaire}
\end{frame}

\begin{frame}{Avantages et inconvénients}
\end{frame}